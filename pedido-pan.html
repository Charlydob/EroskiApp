<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Pedido</title>
  <link rel="stylesheet" href="styles/style.css">
  <link rel="stylesheet" href="styles/calendario.css">
  <link rel="stylesheet" href="styles/pedido-pan.css">
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDN8KAiad5vmKNwhtfd9EUzVgTt2uUapno",
    authDomain: "eroskiapp.firebaseapp.com",
    databaseURL: "https://eroskiapp-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "eroskiapp",
    storageBucket: "eroskiapp.appspot.com",
    messagingSenderId: "1033463841470",
    appId: "1:1033463841470:web:ec92569dd7dabe8a93d4ef"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

   // TEST DE CONEXI√ìN
  db.ref().once("value")
    .then(snapshot => {
      console.log("üî• Firebase ra√≠z:", snapshot.val());
    })
    .catch(err => {
      console.error("‚ùå Error al conectar con Firebase:", err);
    });
</script>

    <script src="navbar.js"></script>

  <script src="scripts/proteccion.js"></script>

  <meta name="theme-color" content="#0b1220" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#0b1220" media="(prefers-color-scheme: dark)">
</head>


<body>
    <nav class="sidebar">
        <a href="index.html"><img src="recursos/img/iniciologo.png" alt="Inicio" class="icon" /></a>
        <a href="balanza.html"><img src="recursos/img/balanzalogo.png" alt="Balanza" class="icon" /></a>
        <a href="calendario.html"><img src="recursos/img/imagenes.png" alt="Calendario" class="icon" /></a>
        <a href="codigos.html"><img src="recursos/img/codigos.png" alt="C√≥digos" class="icon" /></a>
        <a href="tpv.html"><img src="recursos/img/tpv.png" alt="tpv" class="icon" /></a>
        <a href="horarios.html"><img src="recursos/img/calendario.png" alt="Horarios" class="icon" /></a>
    </nav>
 <section id="pedido-app" class="panel">
    <header class="topbar">
      <h1>Pedido de Pan ‚Äî Jefa</h1>
      <div class="bar-actions">
        <label class="chip">
          Entrega:
          <select id="deliver-select">
            <option value="martes">Martes</option>
            <option value="jueves">Jueves</option>
            <option value="sabado">S√°bado</option>
          </select>
        </label>
        <button id="btn-save-order" class="btn primary">Guardar pedido</button>
        <button id="btn-seed" class="btn ghost">Cargar cat√°logo (si falta)</button>
      </div>

      <nav class="tabs">
        <button data-tab="tab-pedido" class="tab active">Pedido</button>
        <button data-tab="tab-catalogo" class="tab">Cat√°logo</button>
        <button data-tab="tab-medianas" class="tab">Medianas</button>
        <button data-tab="tab-ventas" class="tab">Ventas</button>
        <button data-tab="tab-consumo" class="tab">Consumo</button>
        <button data-tab="tab-ritmos" class="tab">Ritmos</button>
      </nav>
    </header>

    <div id="warn-no-fb" class="warn" style="display:none">
      ‚ö†Ô∏è Falta Firebase inicializado (igual que en tus otras p√°ginas).
    </div>
<!-- PEDIDO -->
<section id="tab-pedido" class="tabpage active">
  <div class="hint">
    Basado en <b>plan de 4 semanas √ó (Mar/Jue/S√°b)</b>. Edita <b>Cajas</b> del
    <b>pr√≥ximo cami√≥n</b> (seg√∫n semana auto) y ver√°s <b>lo que sobrar√°</b>.
    El <b>plan</b> es editable y se guarda.
  </div>
  <div id="pedido-list" class="cards"></div>
</section>

    <!-- CAT√ÅLOGO -->
    <section id="tab-catalogo" class="tabpage">
      <div class="toolbar">
        <button id="btn-add-product" class="btn">A√±adir producto</button>
        <button id="btn-save-stock" class="btn">Guardar stock</button>
      </div>
      <table class="table">
        <thead>
          <tr>
            <th>Producto</th><th>u/caja</th><th>Estado</th><th>ref.</th><th>Stock</th><th></th>
          </tr>
        </thead>
        <tbody id="tb-catalogo"></tbody>
      </table>
    </section>

    <!-- MEDIANAS -->
    <section id="tab-medianas" class="tabpage">
      <div class="hint">Medianas por d√≠a (L‚ÜíD) usadas en el c√°lculo.</div>
      <table class="table">
        <thead>
          <tr>
            <th>Producto</th><th>L</th><th>M</th><th>X</th><th>J</th><th>V</th><th>S</th><th>D</th><th></th>
          </tr>
        </thead>
        <tbody id="tb-medianas"></tbody>
      </table>
    </section>

    <!-- VENTAS -->
    <section id="tab-ventas" class="tabpage">
      <div class="toolbar">
        <label class="chip">Fecha <input id="ventas-date" type="date"></label>
        <button id="btn-save-sales" class="btn">Guardar ventas</button>
      </div>
      <table class="table">
        <thead><tr><th>Producto</th><th>Unidades</th></tr></thead>
        <tbody id="tb-ventas"></tbody>
      </table>
    </section>

    <!-- CONSUMO -->
    <section id="tab-consumo" class="tabpage">
      <div class="hint">Filas <span class="badge provisional">amarillas</span> = consumo estimado por cambios de stock.</div>
      <div class="toolbar">
        <label class="chip">Fecha <input id="consumo-date" type="date"></label>
        <button id="btn-add-consumo" class="btn">A√±adir consumo manual</button>
        <button id="btn-save-consumo" class="btn">Guardar consumo</button>
      </div>
      <table class="table">
        <thead>
          <tr><th>Fecha</th><th>Producto</th><th>Œî Unid.</th><th>D√≠as</th><th>u/d√≠a</th><th>Tipo</th></tr>
        </thead>
        <tbody id="tb-consumo"></tbody>
      </table>
    </section>

    <!-- RITMOS -->
    <section id="tab-ritmos" class="tabpage">
      <div class="hint">Resumen: U/mes (estimado), Cajas/mes, Cajas/sem, D√≠as/caja (din√°mico con medianas).</div>
      <table class="table">
        <thead>
          <tr><th>Producto</th><th>U/mes</th><th>Cajas/mes</th><th>Cajas/sem</th><th>D√≠as/caja</th></tr>
        </thead>
        <tbody id="tb-ritmos"></tbody>
      </table>
    </section>
  </section>

  <!-- MODAL EDICI√ìN / ELIMINACI√ìN -->
  <div id="edit-modal" class="modal" aria-hidden="true">
    <div class="modal__box">
      <header class="modal__head">
        <h3 id="modal-title">Editar producto</h3>
        <button class="btn icon" id="modal-close" aria-label="Cerrar">‚úï</button>
      </header>
      <div class="modal__body">
        <form id="modal-form">
          <input type="hidden" id="m-id">
          <div class="grid2">
            <label>Nombre
              <input type="text" id="m-name" required>
            </label>
            <label>u/caja
              <input type="number" id="m-ucaja" min="1" required>
            </label>
            <label>Estado
              <select id="m-estado">
                <option>HAY</option>
                <option>NO HAY</option>
              </select>
            </label>
            <label>Ref.
              <input type="text" id="m-ref">
            </label>
            <label>Stock (uds)
              <input type="number" id="m-stock" min="0" required>
            </label>
          </div>

<fieldset class="fieldset">
  <legend>Plan semanal (cajas) ‚Äî 4 semanas √ó Mar/Jue/S√°b</legend>
  <div style="overflow:auto">
    <table class="table">
      <thead>
        <tr><th></th><th>Martes</th><th>Jueves</th><th>S√°bado</th></tr>
      </thead>
      <tbody>
        <tr><td>Semana 1</td>
          <td><input type="number" min="0" id="m-plan-1-martes"></td>
          <td><input type="number" min="0" id="m-plan-1-jueves"></td>
          <td><input type="number" min="0" id="m-plan-1-sabado"></td>
        </tr>
        <tr><td>Semana 2</td>
          <td><input type="number" min="0" id="m-plan-2-martes"></td>
          <td><input type="number" min="0" id="m-plan-2-jueves"></td>
          <td><input type="number" min="0" id="m-plan-2-sabado"></td>
        </tr>
        <tr><td>Semana 3</td>
          <td><input type="number" min="0" id="m-plan-3-martes"></td>
          <td><input type="number" min="0" id="m-plan-3-jueves"></td>
          <td><input type="number" min="0" id="m-plan-3-sabado"></td>
        </tr>
        <tr><td>Semana 4</td>
          <td><input type="number" min="0" id="m-plan-4-martes"></td>
          <td><input type="number" min="0" id="m-plan-4-jueves"></td>
          <td><input type="number" min="0" id="m-plan-4-sabado"></td>
        </tr>
      </tbody>
    </table>
  </div>
</fieldset>

        </form>
      </div>
      <footer class="modal__foot">
        <button id="modal-delete" class="btn danger">Eliminar</button>
        <div style="flex:1"></div>
        <button id="modal-cancel" class="btn">Cancelar</button>
        <button id="modal-save" class="btn primary">Guardar</button>
      </footer>
    </div>
  </div>

  <script src="scripts/pedido-pan.js"></script>
</body>
</html>